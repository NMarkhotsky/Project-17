{"mappings":"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","sources":["src/scripts/search-area.js","node_modules/@parcel/runtime-js/lib/runtime-b4d5719f2551d9c4.js","node_modules/@parcel/runtime-js/lib/runtime-cfb2d28798f4373f.js","node_modules/@parcel/runtime-js/lib/runtime-2a5f472f2b184fdd.js"],"sourcesContent":["import NewsApi from './API/newsAPI';\nimport formatedDate from './API/fetchAPI';\n//import { requestDate } from './calendar';\n\nconst refs = {\n  form: document.querySelector('.form'),\n  input: document.querySelector('.form__input'),\n  list: document.querySelector('.cards__list--home'),\n  iconSvg: new URL('../img/symbol-defs.svg', import.meta.url),\n  cardListFavorite: document.querySelector('.cards__list-favorite'),\n};\n\nrefs.form.addEventListener('submit', onSubmit);\n\nconst addFavoriteBtnHTML = `Add to favorite ${createSvgIcon('icon-heart')}`;\nconst removeFavoriteBtnHTML = `Remove from favorite ${createSvgIcon(\n  'icon-heart-full'\n)}`;\n\nfunction onSubmit(e) {\n  e.preventDefault();\n  if (refs.input.value.trim() === '') {\n    return;\n  }\n  const newsApi = new NewsApi();\n  newsApi.searchQuery = refs.input.value;\n  //newsApi.begin_date = requestDate;\n  //newsApi.end_date = requestDate;\n  if (false) {\n    //newsApi.fetchOnSearchQueryByDate().then(({ docs }) => {\n    //  refs.list.innerHTML = '';\n    //  if (docs.length === 0) {\n    //    const img = new URL('../img/not-found-desktop.png', import.meta.url);\n    //    const markupWithNotFoundImg = `<img src=\"${img}\" alt=\"We haven't found news at your request\">`;\n    //    refs.list.innerHTML = markupWithNotFoundImg;\n    //  } else {\n    //createMarkup(docs);\n    //  }\n    //});\n  } else {\n    newsApi.fetchOnSearchQuery().then(({ docs }) => {\n      refs.list.innerHTML = '';\n      const favorite = getFavorite();\n      if (docs.length === 0) {\n        const img = new URL('../img/not-found-desktop.png', import.meta.url);\n        const markupWithNotFoundImg = `<img src=\"${img}\" alt=\"We haven't found news at your request\">`;\n        refs.list.innerHTML = markupWithNotFoundImg;\n      } else {\n        const list = docs\n          .map(item => {\n            const inFavorite = Boolean(favorite?.hasOwnProperty(item._id));\n            return createMarkupForCardOnSearch(item, inFavorite);\n          })\n          .join('');\n        refs.list.innerHTML = list;\n      }\n    });\n  }\n}\n\nexport function createMarkupForCardOnSearch(\n  news,\n  inFavourite,\n  deleteFromDom = false\n) {\n  const {\n    abstract,\n    pub_date,\n    multimedia,\n    section_name,\n    headline,\n    web_url,\n    _id,\n  } = news;\n  const id = _id.replace(/[^+\\d]/g, '');\n  const published_date = pub_date;\n  const section = section_name;\n  const title = headline.main;\n  const url = web_url;\n  const toggleFavourite = () => {\n    const btn = document.querySelector(`.button__add-favorite--${id}`);\n    btn.classList.toggle('button__add-favorite--active');\n    if (btn.classList.contains('button__add-favorite--active')) {\n      btn.innerHTML = removeFavoriteBtnHTML;\n    } else {\n      btn.innerHTML = addFavoriteBtnHTML;\n    }\n  };\n  let imageUrl = null;\n  if (!multimedia[0]) {\n    imageUrl = new URL('../img/not-found-desktop.png', import.meta.url);\n  } else {\n    imageUrl = new URL(\n      `https://www.nytimes.com/${multimedia[0]?.url}`,\n      import.meta.url\n    );\n  }\n  setTimeout(() => {\n    if (inFavourite) {\n      toggleFavourite();\n    }\n    const btn = document.querySelector(`.button__add-favorite--${id}`);\n    btn.onclick = handleFavorite(id, news);\n  }, 0);\n\n  const handleFavorite = (newsId, data) => () => {\n    toggleFavourite();\n    const favorite = getFavorite();\n\n    let newFavourite = favorite;\n\n    if (favorite.hasOwnProperty(newsId)) {\n      delete newFavourite[newsId];\n      if (deleteFromDom) {\n        const cardElement = document.querySelector(`.card_item-${newsId}`);\n        cardElement.remove();\n      }\n    } else {\n      const saveFavorite = {\n        [newsId]: data,\n      };\n      newFavourite = { ...favorite, ...saveFavorite };\n    }\n    localStorage.setItem('favoriteBySearch', JSON.stringify(newFavourite));\n  };\n\n  return `\n  <div class=\"card_item card_item-${id}\">\n    <div class=\"card_item-header\">\n      <img class=\"card_item-image\" src=\"${imageUrl}\" alt=\"${'imageCaption'}\" loading=\"lazy\" />\n      <span class=\"card_item-section\">${section}</span>\n      <button class=\"button__add-favorite ${`button__add-favorite--${id}`}\" data-id=\"${id}\">\n        ${addFavoriteBtnHTML}\n      </button>\n    </div>\n    <div class=\"cart_item-content\">\n      <div class=\"card_item-text\">\n        <h1 class=\"card_item-title\">${title}</h1>\n        <p class=\"card_item-description\">${abstract}</p>\n      </div>\n      <div class=\"card_item-info\">\n        <span class=\"card_item-date\">${formatedDate(published_date)}</span>\n        <a class=\"card__link-btn\" href=\"${url}\" data-title=\"${title}\">\n          <button class=\"button__read-more\">\n            Read more\n          </button>\n        </a>\n      </div>\n    </div>\n  </div>\n  `;\n}\nfunction createSvgIcon(name) {\n  return `\n    <svg class=\"button__icon-svg\">\n      <use href=\"${refs.iconSvg}#${name}\"></use>\n    </svg>\n  `;\n}\nexport function getFavorite() {\n  const favorite = JSON.parse(localStorage.getItem('favoriteBySearch')) || {};\n\n  return favorite;\n}\n","module.exports = require('./helpers/bundle-url').getBundleURL('1sXBe') + require('./helpers/bundle-manifest').resolve(\"4BzQQ\");","module.exports = require('./helpers/bundle-url').getBundleURL('1sXBe') + require('./helpers/bundle-manifest').resolve(\"8yCin\");","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"1sXBe\\\":\\\"index.7a72a146.js\\\",\\\"4BzQQ\\\":\\\"symbol-defs.0d828f66.svg\\\",\\\"8yCin\\\":\\\"not-found-desktop.a4722253.png\\\"}\"));"],"names":["$hKHmD","parcelRequire","$da6f59190d49fcb5$var$refs","form","document","querySelector","input","list","iconSvg","URL","cardListFavorite","addEventListener","e","preventDefault","value","trim","newsApi","$cFA0N","default","searchQuery","fetchOnSearchQuery","then","param","docs","innerHTML","favorite","$da6f59190d49fcb5$export$fce5eda070ce88d0","length","img","markupWithNotFoundImg","concat","map","item","$da6f59190d49fcb5$export$3313c91dcfe7ba2","Boolean","hasOwnProperty","_id","join","$da6f59190d49fcb5$var$addFavoriteBtnHTML","$da6f59190d49fcb5$var$createSvgIcon","$da6f59190d49fcb5$var$removeFavoriteBtnHTML","news","inFavourite","ref","deleteFromDom","arguments","abstract","pub_date","multimedia","section_name","headline","web_url","id","replace","published_date","section","title","main","url","toggleFavourite","btn","classList","toggle","contains","imageUrl","setTimeout","onclick","handleFavorite","newsId","data","newFavourite","remove","saveFavorite","$parcel$interopDefault","$dDDEV","localStorage","setItem","JSON","stringify","$6ShQF","name","parse","getItem","module","exports","getBundleURL","resolve","register"],"version":3,"file":"index.7a72a146.js.map"}