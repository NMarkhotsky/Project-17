{"mappings":"qtBAAA,IAAAA,EAAAC,EAAA,S,aAIA,MAAMC,EAAO,CACXC,KAAMC,SAASC,cAAc,SAC7BC,MAAOF,SAASC,cAAc,gBAC9BE,KAAMH,SAASC,cAAc,sBAC7BG,QAAO,IAAAC,IAAAR,EAAA,UACPS,iBAAkBN,SAASC,cAAc,0BAG3CH,EAAKC,KAAKQ,iBAAiB,UAO3B,SAAkBC,GAEhB,GADAA,EAAEC,iBAC8B,KAA5BX,EAAKI,MAAMQ,MAAMC,OACnB,OAEF,MAAMC,EAAU,IAAI,EAAAhB,EAAAiB,SACpBD,EAAQE,YAAchB,EAAKI,MAAMQ,MAe/BE,EAAQG,qBAAqBC,MAAK,EAACC,KAAEA,MACnCnB,EAAKK,KAAKe,UAAY,GACtB,MAAMC,EAAWC,IACjB,GAAoB,IAAhBH,EAAKI,OAAc,CACrB,MACMC,EAAwB,aADrB,IAAAjB,IAAAR,EAAA,0DAETC,EAAKK,KAAKe,UAAYI,C,KACjB,CACL,MAAMnB,EAAOc,EACVM,KAAIC,GAEIC,EAA4BD,EADhBE,QAAQP,GAAUQ,eAAeH,EAAKI,SAG1DC,KAAK,IACR/B,EAAKK,KAAKe,UAAYf,C,QAxC9B,MAAM2B,EAAqB,mBAAmBC,EAAc,gBACtDC,EAAwB,wBAAwBD,EACpD,qBA4CK,SAASN,EACdQ,EACAC,EACAC,GAAgB,GAEhB,MAAMC,SACJA,EAAQC,SACRA,EAAQC,WACRA,EAAUC,aACVA,EAAYC,SACZA,EAAQC,QACRA,EAAOb,IACPA,GACEK,EACES,EAAKd,EAAIe,QAAO,UAAY,IAC5BC,EAAiBP,EACjBQ,EAAUN,EACVO,EAAQN,EAASO,KACjBC,EAAMP,EACNQ,EAAkB,KACtB,MAAMC,EAAMlD,SAASC,cAAc,0BAA0ByC,KAC7DQ,EAAIC,UAAUC,OAAO,gCACjBF,EAAIC,UAAUE,SAAS,gCACzBH,EAAIhC,UAAYc,EAEhBkB,EAAIhC,UAAYY,CAAkB,EAGtC,IAAIwB,EAAW,KAIbA,EAHGhB,EAAW,GAGH,IAAIjC,IACb,2BAA2BiC,EAAW,IAAIU,MAAK,sCAHzC,IAAA3C,IAAAR,EAAA,UAOV0D,YAAW,KACLrB,GACFe,IAEUjD,SAASC,cAAc,0BAA0ByC,KACzDc,QAAUC,EAAef,EAAIT,EAAK,GACrC,GAEH,MAAMwB,EAAiB,CAACC,EAAQC,IAAS,KACvCV,IACA,MAAM9B,EAAWC,IAEjB,IAAIwC,EAAezC,EAEnB,GAAIA,EAASQ,eAAe+B,IAE1B,UADOE,EAAaF,GAChBvB,EAAe,CACGnC,SAASC,cAAc,cAAcyD,KAC7CG,Q,MAET,CACL,MAAMC,EAAe,CACnBJ,CAACA,GAASC,GAEZC,EAAe,IAAKzC,KAAa2C,E,CAEnCC,aAAaC,QAAQ,mBAAoBC,KAAKC,UAAUN,GAAc,EAGxE,MAAO,uCAC2BlB,oFAEMY,kFACFT,6EAC6BH,eAAkBA,gBAC7EZ,gJAK4BgB,oDACKV,kGAGJ,EAAA+B,EAAAtD,SAAa+B,sDACVI,kBAAoBF,qJ,CAU9D,SAASf,EAAcqC,GACrB,MAAO,0DAEUtE,EAAKM,WAAWgE,2B,CAI5B,SAAShD,IAGd,OAFiB6C,KAAKI,MAAMN,aAAaO,QAAQ,sBAAwB,E,uCChK3EC,EAAAC,QAAiB,IAAAnE,IAAoBR,EAAA,SAAA4E,QAA6C,SAAQC,OAAAC,KAAA3B,KAAE4B,U,sCCA5FL,EAAAC,QAAiB,IAAAnE,IAAoBR,EAAA,SAAA4E,QAA6C,SAAQC,OAAAC,KAAA3B,KAAE4B,U,ICA5F/E,EAAA,SAAAgF,SAA8CZ,KAAKI,MAAM","sources":["src/scripts/search-area.js","node_modules/@parcel/runtime-js/lib/runtime-094d1b7e61d55c79.js","node_modules/@parcel/runtime-js/lib/runtime-c263ac25c64cf903.js","node_modules/@parcel/runtime-js/lib/runtime-5b4abde9118f3f63.js"],"sourcesContent":["import NewsApi from './API/newsAPI';\nimport formatedDate from './API/fetchAPI';\n//import { requestDate } from './calendar';\n\nconst refs = {\n  form: document.querySelector('.form'),\n  input: document.querySelector('.form__input'),\n  list: document.querySelector('.cards__list--home'),\n  iconSvg: new URL('../img/symbol-defs.svg', import.meta.url),\n  cardListFavorite: document.querySelector('.cards__list-favorite'),\n};\n\nrefs.form.addEventListener('submit', onSubmit);\n\nconst addFavoriteBtnHTML = `Add to favorite ${createSvgIcon('icon-heart')}`;\nconst removeFavoriteBtnHTML = `Remove from favorite ${createSvgIcon(\n  'icon-heart-full'\n)}`;\n\nfunction onSubmit(e) {\n  e.preventDefault();\n  if (refs.input.value.trim() === '') {\n    return;\n  }\n  const newsApi = new NewsApi();\n  newsApi.searchQuery = refs.input.value;\n  //newsApi.begin_date = requestDate;\n  //newsApi.end_date = requestDate;\n  if (false) {\n    //newsApi.fetchOnSearchQueryByDate().then(({ docs }) => {\n    //  refs.list.innerHTML = '';\n    //  if (docs.length === 0) {\n    //    const img = new URL('../img/not-found-desktop.png', import.meta.url);\n    //    const markupWithNotFoundImg = `<img src=\"${img}\" alt=\"We haven't found news at your request\">`;\n    //    refs.list.innerHTML = markupWithNotFoundImg;\n    //  } else {\n    //createMarkup(docs);\n    //  }\n    //});\n  } else {\n    newsApi.fetchOnSearchQuery().then(({ docs }) => {\n      refs.list.innerHTML = '';\n      const favorite = getFavorite();\n      if (docs.length === 0) {\n        const img = new URL('../img/not-found-desktop.png', import.meta.url);\n        const markupWithNotFoundImg = `<img src=\"${img}\" alt=\"We haven't found news at your request\">`;\n        refs.list.innerHTML = markupWithNotFoundImg;\n      } else {\n        const list = docs\n          .map(item => {\n            const inFavorite = Boolean(favorite?.hasOwnProperty(item._id));\n            return createMarkupForCardOnSearch(item, inFavorite);\n          })\n          .join('');\n        refs.list.innerHTML = list;\n      }\n    });\n  }\n}\n\nexport function createMarkupForCardOnSearch(\n  news,\n  inFavourite,\n  deleteFromDom = false\n) {\n  const {\n    abstract,\n    pub_date,\n    multimedia,\n    section_name,\n    headline,\n    web_url,\n    _id,\n  } = news;\n  const id = _id.replace(/[^+\\d]/g, '');\n  const published_date = pub_date;\n  const section = section_name;\n  const title = headline.main;\n  const url = web_url;\n  const toggleFavourite = () => {\n    const btn = document.querySelector(`.button__add-favorite--${id}`);\n    btn.classList.toggle('button__add-favorite--active');\n    if (btn.classList.contains('button__add-favorite--active')) {\n      btn.innerHTML = removeFavoriteBtnHTML;\n    } else {\n      btn.innerHTML = addFavoriteBtnHTML;\n    }\n  };\n  let imageUrl = null;\n  if (!multimedia[0]) {\n    imageUrl = new URL('../img/not-found-desktop.png', import.meta.url);\n  } else {\n    imageUrl = new URL(\n      `https://www.nytimes.com/${multimedia[0]?.url}`,\n      import.meta.url\n    );\n  }\n  setTimeout(() => {\n    if (inFavourite) {\n      toggleFavourite();\n    }\n    const btn = document.querySelector(`.button__add-favorite--${id}`);\n    btn.onclick = handleFavorite(id, news);\n  }, 0);\n\n  const handleFavorite = (newsId, data) => () => {\n    toggleFavourite();\n    const favorite = getFavorite();\n\n    let newFavourite = favorite;\n\n    if (favorite.hasOwnProperty(newsId)) {\n      delete newFavourite[newsId];\n      if (deleteFromDom) {\n        const cardElement = document.querySelector(`.card_item-${newsId}`);\n        cardElement.remove();\n      }\n    } else {\n      const saveFavorite = {\n        [newsId]: data,\n      };\n      newFavourite = { ...favorite, ...saveFavorite };\n    }\n    localStorage.setItem('favoriteBySearch', JSON.stringify(newFavourite));\n  };\n\n  return `\n  <div class=\"card_item card_item-${id}\">\n    <div class=\"card_item-header\">\n      <img class=\"card_item-image\" src=\"${imageUrl}\" alt=\"${'imageCaption'}\" loading=\"lazy\" />\n      <span class=\"card_item-section\">${section}</span>\n      <button class=\"button__add-favorite ${`button__add-favorite--${id}`}\" data-id=\"${id}\">\n        ${addFavoriteBtnHTML}\n      </button>\n    </div>\n    <div class=\"cart_item-content\">\n      <div class=\"card_item-text\">\n        <h1 class=\"card_item-title\">${title}</h1>\n        <p class=\"card_item-description\">${abstract}</p>\n      </div>\n      <div class=\"card_item-info\">\n        <span class=\"card_item-date\">${formatedDate(published_date)}</span>\n        <a class=\"card__link-btn\" href=\"${url}\" data-title=\"${title}\">\n          <button class=\"button__read-more\">\n            Read more\n          </button>\n        </a>\n      </div>\n    </div>\n  </div>\n  `;\n}\nfunction createSvgIcon(name) {\n  return `\n    <svg class=\"button__icon-svg\">\n      <use href=\"${refs.iconSvg}#${name}\"></use>\n    </svg>\n  `;\n}\nexport function getFavorite() {\n  const favorite = JSON.parse(localStorage.getItem('favoriteBySearch')) || {};\n\n  return favorite;\n}\n","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"6RkRa\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"iVvoC\")).toString();","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"b3ZSW\\\":\\\"index.fd1743a5.js\\\",\\\"6RkRa\\\":\\\"symbol-defs.0583f717.svg\\\",\\\"iVvoC\\\":\\\"not-found-desktop.a4722253.png\\\"}\"));"],"names":["$fWY1B","parcelRequire","$882dfffc7bc99607$var$refs","form","document","querySelector","input","list","iconSvg","URL","cardListFavorite","addEventListener","e","preventDefault","value","trim","newsApi","default","searchQuery","fetchOnSearchQuery","then","docs","innerHTML","favorite","$882dfffc7bc99607$export$fce5eda070ce88d0","length","markupWithNotFoundImg","map","item","$882dfffc7bc99607$export$3313c91dcfe7ba2","Boolean","hasOwnProperty","_id","join","$882dfffc7bc99607$var$addFavoriteBtnHTML","$882dfffc7bc99607$var$createSvgIcon","$882dfffc7bc99607$var$removeFavoriteBtnHTML","news","inFavourite","deleteFromDom","abstract","pub_date","multimedia","section_name","headline","web_url","id","replace","published_date","section","title","main","url","toggleFavourite","btn","classList","toggle","contains","imageUrl","setTimeout","onclick","handleFavorite","newsId","data","newFavourite","remove","saveFavorite","localStorage","setItem","JSON","stringify","$eeO3V","name","parse","getItem","module","exports","resolve","import","meta","toString","register"],"version":3,"file":"index.fd1743a5.js.map"}